<!DOCTYPE html>
<html lang="en" >

<head>
  <meta charset="UTF-8">
  <title>tgr.am Editor</title>
    <!-- Import Ionicon icons & Google Fonts our Bootstrap theme relies on -->
    <link href="//code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Titillium+Web:700|Source+Serif+Pro:400,700|Merriweather+Sans:400,700|Source+Sans+Pro:400,300,600,700,300italic,400italic,600italic,700italic" rel="stylesheet" type="text/css">
    <!-- Import the custom Bootstrap 4 theme from our hosted CDN -->
    <link rel="stylesheet" href="//demo.productionready.io/main.css">
    <link rel='stylesheet prefetch' href='http://cdn.quilljs.com/1.3.6/quill.bubble.css'>
    <style>
    html {
        height: 100%;
    }
    body {
        margin: 50;
        height: 100%;
    }

    /* Tell Quill not to scroll */
    #quill-container {
        height: auto;
        min-height: 100%;
    }

    #quill-container .ql-editor {
        font-size: 18px;
        overflow-y: visible; 
    }

    /* Specify our own scrolling container */
    #scrolling-container {
        padding-left: 0px;
        height: 100%;
        min-height: 100%;
    }
    </style>
</head>

<body>
{{ template "menu" . }}
<div class="container page" id="scrolling-container">
    <div class="row">
        <div class="col-md-9">
            <div id="quill-container" name="quill-container">
            </div>
        </div>
        <div class="col-md-3">
        <div class="sidebar">
            <p>
            <strong>Supported markdown:</strong>
            </p>
<pre>
# Headers
**Bold text**
*Italic*
***Bold italic***
~~Strikethrough~~
- Bullet points
1. Numbered lists
[] Checkboxes
[]() Links
> Blockquote
`Inline code block`
```
Fenced Code block
```
--- Horizontal Rule
</pre>
        </div>
        </div>
  </div>

    
    <button type="submit" class="btn btn-lg btn-primary pull-xs-left" onclick="sen()" >Publish</button>

<script src='http://cdn.quilljs.com/1.3.6/quill.js'></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
<script src="https://rawgit.com/patleeman/quill-markdown-shortcuts/master/dist/markdownShortcuts.js"></script>
<script>
    Quill.register('modules/markdownShortcuts', MarkdownShortcuts)
    var quill = new Quill('#quill-container', {
    modules: {
        markdownShortcuts: {},
        toolbar: [
        [{ header: [1, 2, false] }],
        ['bold', 'italic', 'underline'],
        ['image', 'code-block']
        ]
    },
    scrollingContainer: '#scrolling-container', 
    placeholder: 'Compose an epic...',
    theme: 'bubble'
    });
    function sen() {
        //alert(JSON.stringify(quill.getContents()))
        var xhr = new XMLHttpRequest();
        var url = "/editor";
        xhr.open("POST", url, true);
        xhr.setRequestHeader("Content-Type", "application/json");
        xhr.onreadystatechange = function () {
            if (xhr.readyState === 4 && xhr.status === 201) {
                var json = JSON.parse(xhr.responseText);
                window.location.replace('/@'+ json.Author + '/' + json.ID);
                //console.log(json.ID + ", " + json.Author);
            }
        };
        var data = JSON.stringify(quill.getContents())//JSON.stringify({"email": "hey@mail.com", "password": "101010"});
        xhr.send(data);
    }
    /*
    var form = document.querySelector('form');
    form.onsubmit = function() {
        var about = document.querySelector('div[name=quill-container]');
        about.value = JSON.stringify(quill.getContents());
    }*/
    //console.log("Submitted", $(form).serialize(), $(form).serializeArray());
    //alert('Open the console to see the submit data!')

</script>




</body>

</html>
